define(["org/eclipse/edt/rui/widgets/Box","eglx/ui/rui/eze$$Widget","eglx/ui/rui/eze$$Event","org/eclipse/edt/rui/widgets/DataGridColumn","org/eclipse/edt/rui/widgets/DataGrid","org/eclipse/edt/rui/widgets/DataGridLib","org/eclipse/edt/rui/widgets/Div"],function(){egl.defineClass("org.eclipse.edt.rui.widgets","DataGridSelector",{"eze$$fileName":"org/eclipse/edt/rui/widgets/DataGridSelector.egl","eze$$runtimePropertiesFile":"org.eclipse.edt.rui.widgets.DataGridSelector","constructor":function(){new egl.org.eclipse.edt.rui.widgets.DataGridLib();},"eze$$setEmpty":function(){new egl.org.eclipse.edt.rui.widgets.DataGridLib();this.selection=[];this.selectedRows=[];this.color="";this.selectionChangedListener=null;this.grid=null;this.selectedGridRows=[];},"eze$$setInitial":function(){this.eze$$setEmpty();this.selection=[];this.selectedRows=[];this.color="lightgreen";this.selectionChangedListener=null;this.selectedGridRows=[];},"eze$$clone":function(){var _1=this;var _2=new egl.org.eclipse.edt.rui.widgets.DataGridSelector();_2.selection=_1.selection===null?null:_1.selection;_2.selectedRows=_1.selectedRows===null?null:_1.selectedRows;_2.color=_1.color===null?null:_1.color;_2.selectionChangedListener=_1.selectionChangedListener===null?null:_1.selectionChangedListener;_2.grid=_1.grid===null?null:_1.grid.eze$$clone();_2.selectedGridRows=_1.selectedGridRows===null?null:_1.selectedGridRows;return _2;},"eze$$getAnnotations":function(){if(this.annotations===undefined){this.annotations={};this.annotations["XMLRootElement"]=new egl.eglx.xml.binding.annotation.XMLRootElement("DataGridSelector",null,false);}return this.annotations;},"eze$$getFieldInfos":function(){if(this.fieldInfos===undefined){var _3;this.fieldInfos=new Array();_3={};_3["XMLStyle"]=new egl.eglx.xml.binding.annotation.XMLElement("selection",null,false,false);_3["JsonName"]=new egl.eglx.json.JsonName("selection");this.fieldInfos[0]=new egl.eglx.services.FieldInfo("selection","selection","[Aeglx/lang/eany;",egl.eglx.lang.EAny,_3);_3={};_3["XMLStyle"]=new egl.eglx.xml.binding.annotation.XMLElement("selectedRows",null,false,false);_3["JsonName"]=new egl.eglx.json.JsonName("selectedRows");this.fieldInfos[1]=new egl.eglx.services.FieldInfo("selectedRows","selectedRows","[eglx.ui.rui.Widget",egl.eglx.ui.rui.Widget,_3);_3={};_3["XMLStyle"]=new egl.eglx.xml.binding.annotation.XMLElement("color",null,false,false);_3["JsonName"]=new egl.eglx.json.JsonName("color");this.fieldInfos[2]=new egl.eglx.services.FieldInfo("color","color","S;",String,_3);_3={};_3["XMLStyle"]=new egl.eglx.xml.binding.annotation.XMLElement("grid",null,false,false);_3["JsonName"]=new egl.eglx.json.JsonName("grid");this.fieldInfos[4]=new egl.eglx.services.FieldInfo("grid","grid","org.eclipse.edt.rui.widgets.DataGrid",egl.org.eclipse.edt.rui.widgets.DataGrid,_3);}return this.fieldInfos;},"enableSelection":function(_4,td,_5,_6,_7){_4.setSelectionMode(egl.checkNull(egl.org.eclipse.edt.rui.widgets.DataGridLib["$inst"]).DISABLE_SELECTION);if((egl.eglx.lang.EAny.equals(egl.checkNull(this).grid,null))){egl.checkNull(this).grid=_4;}egl.checkNull(td).getOnClick().appendElement(new egl.egl.jsrt.Delegate(this,egl.org.eclipse.edt.rui.widgets.DataGridSelector.prototype.setSelected));td.setAttribute("originalBG",egl.eglx.lang.convert(egl.eglx.lang.EAny.fromEAny,[egl.checkNull(td).getBackgroundColor(),"S;"]));_4.setCursor("pointer");},"setSelected":function(e){var _8;_8=egl.checkNull(e).widget;var _9;_9=egl.checkNull(_8).getParent();var _a;_a=((" ")+egl.eglx.lang.EString.ezeCast(_8.getAttribute("row"),false));var _b;_b=egl.checkNull(egl.checkNull(this.grid).getData())[egl.checkNull(this.grid).getData().checkIndex(egl.eglx.lang.EInt32.ezeCast({eze$$value:egl.eglx.lang.convert(egl.eglx.lang.EInt32.fromEString,[_a]),eze$$signature:"I;"},false)-1)];if(((egl.checkNull(e).ctrlKey||egl.checkNull(e).metaKey))){var _c;_c=this.selectionIndex(_9);if(((_c==0))){this.selection.appendElement(egl.checkNull(_b));var _d=new egl.org.eclipse.edt.rui.widgets.Box();_d.setColumns(egl.checkNull(_9).getChildren().getSize());var n=0;for(n=1;((n<=egl.checkNull(_d).getColumns()));n=((n+1))){var _e=null;var _f;_f=(function(){var _10=new egl.org.eclipse.edt.rui.widgets.Div();return _10;}).call(this);_f.setInnerHTML(egl.checkNull(egl.checkNull(egl.checkNull(_9).getChildren())[egl.checkNull(_9).getChildren().checkIndex(egl.eglx.lang.EInt32.ezeCast({eze$$value:n,eze$$signature:"I;"},false)-1)]).getInnerHTML());_f.setBackgroundColor(this.color);_f.setMargin(1);_e=_f;_d.appendChild(egl.checkNull(egl.eglx.lang.convert(egl.eglx.ui.rui.Widget.fromWidget,[_e,"org.eclipse.edt.rui.widgets.Div"])));}var tr;tr=egl.checkNull(egl.checkNull(_d).lastRow);tr.setAttribute("row",egl.eglx.lang.convert(egl.eglx.lang.EAny.fromEAny,[_a,"S;"]));this.selectedRows.appendElement(egl.checkNull(tr));this.selectedGridRows.appendElement(egl.checkNull(_9));this.highlightRow(_9);}else{this.unHighlightRow(_9);this.selection.removeElement(_c);this.selectedRows.removeElement(_c);this.selectedGridRows.removeElement(_c);}}else{this.unHighlightRows(this.selectedGridRows);this.selection=[_b].setType("[Aeglx/lang/eany;");var _d=new egl.org.eclipse.edt.rui.widgets.Box();_d.setColumns(egl.checkNull(_9).getChildren().getSize());var n=0;for(n=1;((n<=egl.checkNull(_d).getColumns()));n=((n+1))){var _11=null;var _f;_f=(function(){var _12=new egl.org.eclipse.edt.rui.widgets.Div();return _12;}).call(this);_f.setInnerHTML(egl.checkNull(egl.checkNull(egl.checkNull(_9).getChildren())[egl.checkNull(_9).getChildren().checkIndex(egl.eglx.lang.EInt32.ezeCast({eze$$value:n,eze$$signature:"I;"},false)-1)]).getInnerHTML());_f.setBackgroundColor(this.color);_f.setMargin(1);_11=_f;_d.appendChild(egl.checkNull(egl.eglx.lang.convert(egl.eglx.ui.rui.Widget.fromWidget,[_11,"org.eclipse.edt.rui.widgets.Div"])));}var tr;tr=egl.checkNull(egl.checkNull(_d).lastRow);tr.setAttribute("row",egl.eglx.lang.convert(egl.eglx.lang.EAny.fromEAny,[_a,"S;"]));this.selectedRows=[tr].setType("[eglx.ui.rui.Widget");this.selectedGridRows=[_9].setType("[eglx.ui.rui.Widget");this.highlightRow(_9);}if((egl.eglx.lang.EAny.notEquals(this.selectionChangedListener,null))){this.selectionChangedListener();}},"selectionIndex":function(tr){var n=0;for(n=1;((n<=this.selectedGridRows.getSize()));n=((n+1))){if((egl.eglx.ui.rui.Widget.equals(egl.checkNull(this.selectedGridRows)[this.selectedGridRows.checkIndex(egl.eglx.lang.EInt32.ezeCast({eze$$value:n,eze$$signature:"I;"},false)-1)],tr))){return n;}}return 0;},"highlightRow":function(tr){var tds;tds=tr.getElementsByTagName("div");var n=0;for(n=1;((n<=tds.getSize()));n=((n+1))){if(egl.eglx.lang.EString.isLike(egl.checkNull(egl.checkNull(tds)[tds.checkIndex(egl.eglx.lang.EInt32.ezeCast({eze$$value:n,eze$$signature:"I;"},false)-1)]).getClass(),"%EglRuiDataGridCell%")){egl.checkNull(tds)[tds.checkIndex(egl.eglx.lang.EInt32.ezeCast({eze$$value:n,eze$$signature:"I;"},false)-1)].setBackgroundColor(this.color);}}tr.setCursor("move");},"unHighlightRow":function(tr){var tds;tds=tr.getElementsByTagName("div");var n=0;for(n=1;((n<=tds.getSize()));n=((n+1))){if(egl.eglx.lang.EString.isLike(egl.checkNull(egl.checkNull(tds)[tds.checkIndex(egl.eglx.lang.EInt32.ezeCast({eze$$value:n,eze$$signature:"I;"},false)-1)]).getClass(),"%EglRuiDataGridCell%")){egl.checkNull(tds)[tds.checkIndex(egl.eglx.lang.EInt32.ezeCast({eze$$value:n,eze$$signature:"I;"},false)-1)].setBackgroundColor(egl.eglx.lang.EString.ezeCast(egl.checkNull(tds)[tds.checkIndex(egl.eglx.lang.EInt32.ezeCast({eze$$value:n,eze$$signature:"I;"},false)-1)].getAttribute("originalBG"),false));}}tr.setCursor("default");},"unHighlightRows":function(trs){var r=0;for(r=1;((r<=trs.getSize()));r=((r+1))){this.unHighlightRow(egl.checkNull(trs)[trs.checkIndex(egl.eglx.lang.EInt32.ezeCast({eze$$value:r,eze$$signature:"I;"},false)-1)]);}},"clear":function(_13){this.unHighlightRows(this.selectedRows);this.selection=[];this.selectedRows=[];},"toString":function(){return "[DataGridSelector]";}});});