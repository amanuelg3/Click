define(["org/eclipse/edt/rui/widgets/Box","eglx/ui/rui/eze$$Widget","eglx/ui/rui/eze$$Event","org/eclipse/edt/rui/widgets/Shadow","org/eclipse/edt/rui/widgets/HTML","eglx/javascript/eze$$Job","org/eclipse/edt/rui/widgets/Div"],function(){egl.loadCSS("css/org.eclipse.edt.rui.css");egl.defineRUIWidget("org.eclipse.edt.rui.widgets","Tooltip",{"eze$$fileName":"org/eclipse/edt/rui/widgets/Tooltip.egl","eze$$runtimePropertiesFile":"org.eclipse.edt.rui.widgets.Tooltip","constructor":function(){this.start();},"eze$$setEmpty":function(){this.provider=null;this.delay=0;this.text=null;this.container=new egl.org.eclipse.edt.rui.widgets.Div();this.shadow=new egl.org.eclipse.edt.rui.widgets.Shadow();this.tooltip=new egl.org.eclipse.edt.rui.widgets.Box();this.defaultTip=new egl.org.eclipse.edt.rui.widgets.Box();this.showJob=new egl.eglx.javascript.Job();this.hideJob=new egl.eglx.javascript.Job();this.insideTarget=false;},"eze$$setInitial":function(){this.eze$$setEmpty();this.delay=400;this.text=null;this.container.setClass("EglRuiTooltip");egl.checkNull(this.container).getOnMouseOver().appendElement(new egl.egl.jsrt.Delegate(this,egl.org.eclipse.edt.rui.widgets.Tooltip.prototype.enterTooltip));egl.checkNull(this.container).getOnMouseOut().appendElement(new egl.egl.jsrt.Delegate(this,egl.org.eclipse.edt.rui.widgets.Tooltip.prototype.leaveTooltip));this.shadow.setDiv(this.container);this.tooltip.setChildren([egl.eglx.lang.convert(egl.eglx.ui.rui.Widget.fromWidget,[this.shadow,"org.eclipse.edt.rui.widgets.Shadow"])].setType("[org.eclipse.edt.rui.widgets.Shadow"));this.tooltip.setVisibility("hidden");this.tooltip.setZIndex("99");this.tooltip.setPosition("absolute");this.defaultTip.setChildren([egl.eglx.lang.convert(egl.eglx.ui.rui.Widget.fromWidget,[(function(){var _1=new egl.org.eclipse.edt.rui.widgets.HTML();return _1;}).call(this),"org.eclipse.edt.rui.widgets.HTML"])].setType("[org.eclipse.edt.rui.widgets.HTML"));this.showJob.setRunFunction(new egl.egl.jsrt.Delegate(this,egl.org.eclipse.edt.rui.widgets.Tooltip.prototype.showTooltip));this.hideJob.setRunFunction(new egl.egl.jsrt.Delegate(this,egl.org.eclipse.edt.rui.widgets.Tooltip.prototype.hideTooltip));},"eze$$clone":function(){var _2=this;var _3=new egl.org.eclipse.edt.rui.widgets.Tooltip();_3.provider=_2.provider===null?null:_2.provider;_3.delay=_2.delay;_3.text=_2.text===null?null:_2.text;_3.container=_2.container===null?null:_2.container.eze$$clone();_3.shadow=_2.shadow===null?null:_2.shadow.eze$$clone();_3.tooltip=_2.tooltip===null?null:_2.tooltip.eze$$clone();_3.defaultTip=_2.defaultTip===null?null:_2.defaultTip.eze$$clone();_3.showJob=_2.showJob===null?null:_2.showJob;_3.hideJob=_2.hideJob===null?null:_2.hideJob;_3.insideTarget=_2.insideTarget;return _3;},"eze$$getAnnotations":function(){if(this.annotations===undefined){this.annotations={};this.annotations["XMLRootElement"]=new egl.eglx.xml.binding.annotation.XMLRootElement("Tooltip",null,false);}return this.annotations;},"eze$$getFieldInfos":function(){if(this.fieldInfos===undefined){var _4;this.fieldInfos=new Array();_4={};_4["XMLStyle"]=new egl.eglx.xml.binding.annotation.XMLElement("delay",null,false,false);_4["JsonName"]=new egl.eglx.json.JsonName("delay");this.fieldInfos[1]=new egl.eglx.services.FieldInfo("delay","delay","I;",Number,_4);_4={};_4["XMLStyle"]=new egl.eglx.xml.binding.annotation.XMLElement("text",null,false,false);_4["JsonName"]=new egl.eglx.json.JsonName("text");this.fieldInfos[2]=new egl.eglx.services.FieldInfo("text","text","S;",String,_4);}return this.fieldInfos;},"start":function(){egl.checkNull(egl.checkNull(this).document).body.appendChild(egl.eglx.lang.convert(egl.eglx.ui.rui.Widget.fromWidget,[this.tooltip,"org.eclipse.edt.rui.widgets.Box"]));},"enable":function(_5){var _6;_6=egl.eglx.lang.EAny.ezeCast(_5,egl.eglx.ui.rui.Widget);egl.checkNull(_6).getOnMouseOver().appendElement(new egl.egl.jsrt.Delegate(this,egl.org.eclipse.edt.rui.widgets.Tooltip.prototype.activateTooltip));egl.checkNull(_6).getOnMouseOut().appendElement(new egl.egl.jsrt.Delegate(this,egl.org.eclipse.edt.rui.widgets.Tooltip.prototype.deactivateTooltip));egl.checkNull(_6).getOnClick().appendElement(new egl.egl.jsrt.Delegate(this,egl.org.eclipse.edt.rui.widgets.Tooltip.prototype.leaveTooltip));},"deactivateTooltip":function(e){this.hideJob.schedule(this.delay);this.insideTarget=false;},"activateTooltip":function(e){this.insideTarget=true;var _7;_7=egl.checkNull(e).widget;var _8;_8=null;if((((egl.eglx.lang.EAny.equals(this.provider,null))&&(egl.eglx.lang.EAny.notEquals(this.text,null))))){_8=this.defaultTip;egl.eglx.lang.EAny.ezeCast({eze$$value:egl.checkNull(egl.checkNull(_8).getChildren())[egl.checkNull(_8).getChildren().checkIndex(egl.eglx.lang.EInt32.ezeCast({eze$$value:1,eze$$signature:"I;"},false)-1)],eze$$signature:"eglx.ui.rui.Widget"},egl.org.eclipse.edt.rui.widgets.HTML).setText(this.text);}else{_8=this.provider(egl.eglx.lang.convert(egl.eglx.lang.EAny.fromEAny,[egl.checkNull(e).widget,"eglx.ui.rui.Widget"]));}if((egl.eglx.lang.EAny.notEquals(_8,null))){var h;h=10;if(((egl.checkNull(_7).getHeight())!="auto")){var hs;hs=egl.checkNull(_7).getHeight();if(egl.is(hs,"NUMERIC",egl.isnumeric)){h=egl.eglx.lang.convert(egl.eglx.lang.EInt32.fromEString,[hs]);}else{var _9;_9=egl.eglx.lang.EString.textLen(hs);if(((((_9>2))&&egl.is(egl.eglx.lang.EString.substring(hs,1,((_9-2))),"NUMERIC",egl.isnumeric)))){h=egl.eglx.lang.convert(egl.eglx.lang.EInt32.fromEString,[egl.eglx.lang.EString.substring(hs,1,((_9-2)))]);}}}var y;y=egl.eglx.lang.MathLib.min(((((egl.checkNull(_7).getY()+h))-3)),((egl.checkNull(e).pageY+10)));this.container.removeChildren();this.container.setChildren([egl.eglx.lang.convert(egl.eglx.ui.rui.Widget.fromWidget,[_8,"org.eclipse.edt.rui.widgets.Box"])].setType("[org.eclipse.edt.rui.widgets.Box"));this.container.setOpacity(egl.eglx.lang.convert(egl.eglx.lang.EString.fromEDecimal,[new egl.javascript.BigDecimal("1.0"),"d2:1;"]));this.tooltip.setX(egl.checkNull(e).pageX);this.tooltip.setY(y);this.hideJob.cancel();this.showJob.schedule(this.delay);}else{this.hideTooltip();}e.stopPropagation();},"showTooltip":function(){if(this.insideTarget){this.tooltip.setVisibility("visible");}},"hideTooltip":function(){this.container.fadeOut(300,new egl.egl.jsrt.Delegate(this,egl.org.eclipse.edt.rui.widgets.Tooltip.prototype.setInvisible));this.insideTarget=false;},"setInvisible":function(){this.container.setOpacity(egl.eglx.lang.convert(egl.eglx.lang.EString.fromEDecimal,[new egl.javascript.BigDecimal("1.0"),"d2:1;"]));this.tooltip.setVisibility("hidden");},"enterTooltip":function(e){this.hideJob.cancel();},"leaveTooltip":function(e){this.hideJob.schedule(200);},"toString":function(){return "[Tooltip]";}});});